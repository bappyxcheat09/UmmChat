<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Welcome To Ovis Chatiing Site</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');

  * {
    box-sizing: border-box;
  }
  body {
    font-family: 'Roboto', sans-serif;
    background-color: #121212; /* Dark background for the overall app */
    color: #eee;
    margin: 0; padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    overflow: hidden; /* Prevent body scroll */
  }

  /* --- Login Section Styling --- */
  #login {
    background: linear-gradient(135deg, #2a2a2a, #1a1a1a); /* Subtle dark gradient */
    width: 90vw;
    max-width: 380px; /* Slightly smaller for professionalism */
    border-radius: 15px; /* More rounded */
    padding: 30px; /* More padding */
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.6); /* Deeper, softer shadow */
    animation: fadeIn 0.7s ease-out forwards; /* Slightly slower fade-in */
    display: flex; /* Flexbox for better alignment */
    flex-direction: column;
    align-items: center; /* Center content */
  }

  #login h2 {
    font-size: 1.8em;
    font-weight: 700;
    color: #f0f0f0; /* Lighter color for contrast */
    margin-bottom: 25px; /* More space below title */
    text-align: center;
    letter-spacing: 0.5px; /* Slight letter spacing for style */
  }

  #login input {
    width: 100%;
    padding: 12px 0; /* Adjust padding */
    margin: 10px 0;
    background: transparent; /* Transparent background */
    border: none;
    border-bottom: 2px solid #555; /* Clean bottom border */
    border-radius: 0; /* No border-radius */
    color: #eee;
    font-size: 17px;
    transition: border-bottom-color 0.3s ease, box-shadow 0.3s ease;
  }

  #login input::placeholder {
    color: #aaa; /* Lighter placeholder color */
  }

  #login input:focus {
    outline: none;
    border-bottom-color: #ff69b4; /* Pink border on focus */
    box-shadow: 0 1px 0 0 #ff69b4; /* Subtle shadow for depth on focus */
  }

  #login button {
    width: 100%;
    background: linear-gradient(45deg, #ff69b4, #e652a2); /* Gradient button */
    border: none;
    padding: 16px; /* Larger padding */
    border-radius: 30px; /* Pill-shaped button */
    font-weight: 700; /* Bolder text */
    color: #fff;
    font-size: 18px; /* Larger font size */
    cursor: pointer;
    margin-top: 30px; /* More space above button */
    transition: all 0.3s ease;
    box-shadow: 0 5px 15px rgba(255, 105, 180, 0.4); /* Pink glow shadow */
    letter-spacing: 0.5px;
  }

  #login button:hover {
    background: linear-gradient(45deg, #e652a2, #ff69b4); /* Reverse gradient on hover */
    transform: translateY(-2px) scale(1.02); /* Lift and slightly enlarge */
    box-shadow: 0 8px 20px rgba(255, 105, 180, 0.6);
  }
  #login button:active {
    transform: translateY(0);
    box-shadow: 0 2px 5px rgba(255, 105, 180, 0.3);
  }

  #loginError {
    color: #ff5255;
    text-align: center;
    margin-top: 20px; /* More margin */
    font-size: 16px;
    font-weight: 500;
  }
  /* --- End Login Section Styling --- */


  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(-20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  #chat {
    display: none;
    flex-direction: column;
    width: 100vw; /* Occupy full width on mobile */
    height: 100vh; /* Occupy full height on mobile */
    max-width: 550px; /* Slightly smaller max width for desktop screens */
    max-height: 750px; /* Slightly smaller max height for desktop screens */
    background-color: #1a1a1a; /* Darker background for the chat window itself */
    border-radius: 0; /* No border-radius for full screen */
    box-shadow: none; /* No shadow for full screen */
    overflow: hidden; /* Ensure content stays within */
    position: relative; /* For emoji picker positioning */
  }

  @media (min-width: 600px) { /* Apply border-radius and shadow for larger screens */
    #chat {
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
    }
  }

  .chat-header {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 15px 20px;
    background-color: #202c33;
    border-bottom: 1px solid #333;
  }

  .glowing-title {
    font-size: 1.5em;
    font-weight: 700;
    color: #ff69b4; /* Pinkish glow for love theme */
    text-shadow: 0 0 5px #ff69b4, 0 0 10px #ff69b4, 0 0 20px #ff69b4, 0 0 40px #ff69b4;
    animation: glow 1.8s ease-in-out infinite alternate;
    margin: 0;
    flex-grow: 1;
    text-align: center;
  }

  @keyframes glow {
    from {
      text-shadow: 0 0 5px #ff69b4, 0 0 10px #ff69b4, 0 0 20px #ff69b4, 0 0 40px #ff69b4;
    }
    to {
      text-shadow: 0 0 8px #ff69b4, 0 0 15px #ff69b4, 0 0 30px #ff69b4, 0 0 60px #ff69b4;
    }
  }

  #messages {
    flex: 1;
    overflow-y: auto;
    padding: 15px;
    background:
      radial-gradient(circle at 20% 80%, rgba(255, 105, 180, 0.15) 0%, transparent 50%),
      radial-gradient(circle at 80% 20%, rgba(255, 160, 180, 0.1) 0%, transparent 50%),
      radial-gradient(circle at 50% 50%, rgba(255, 192, 203, 0.08) 0%, transparent 60%); /* Multiple subtle radial gradients */
    background-size: 300% 300%; /* Large background size for movement */
    background-position: 0% 0%; /* Initial position */
    animation: moveLoveBackground 25s ease-in-out infinite alternate; /* Slow, gentle animation */
    border-radius: 0;
    margin-bottom: 0;
    position: relative;
    overflow-x: hidden;
  }

  @keyframes moveLoveBackground {
    0% { background-position: 0% 0%; }
    25% { background-position: 50% 100%; }
    50% { background-position: 100% 0%; }
    75% { background-position: 50% 0%; }
    100% { background-position: 0% 100%; }
  }


  .msg {
    margin-bottom: 8px;
    padding: 10px 12px;
    border-radius: 10px;
    max-width: 80%;
    word-wrap: break-word;
    font-size: 15px;
    line-height: 1.4;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
  }
  .me {
    background: #075e54; /* WhatsApp sent message color (dark green) */
    color: #fff; /* White text for sent messages */
    margin-left: auto;
    border-bottom-right-radius: 3px;
  }
  .other {
    background: #262d31; /* WhatsApp received message color (dark gray/blue) */
    color: #fff; /* White text for received messages */
    margin-right: auto;
    border-bottom-left-radius: 3px;
  }
  #inputArea {
    display: flex;
    gap: 8px;
    align-items: flex-end;
    padding: 10px 15px;
    background-color: #202c33;
    border-top: 1px solid #333;
    position: relative;
  }

  #msgInput {
    flex: 1;
    padding: 12px 15px;
    border-radius: 25px;
    background: #2b2b2b;
    color: #eee;
    font-size: 16px;
    box-shadow: none;
    min-height: 48px;
    resize: none;
    overflow-y: auto;
  }
  #msgInput:focus {
    box-shadow: 0 0 0 2px #ff69b4;
  }

  .emoji-button, #sendBtn {
    width: 48px;
    height: 48px;
    padding: 0;
    border-radius: 50%;
    margin-top: 0;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    font-size: 0;
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-shrink: 0;
    cursor: pointer;
    background: #ff69b4; /* Pink */
    color: #fff;
    transition: background 0.2s ease-in-out;
  }
  .emoji-button:hover, #sendBtn:hover {
    background: #e652a2; /* Darker pink on hover */
  }

  .emoji-button::before {
    content: 'ðŸ˜Š';
    font-size: 22px;
    line-height: 1;
  }

  #sendBtn::before {
    content: 'âž¤';
    font-size: 20px;
    color: #fff;
    line-height: 1;
    transform: rotate(45deg) translateY(-2px) translateX(2px);
  }

  /* Emoji Picker Styles */
  #emojiPickerContainer {
    position: absolute;
    bottom: 70px;
    left: 15px;
    right: 15px;
    background-color: #2c3e50;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
    padding: 10px;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(30px, 1fr));
    gap: 5px;
    max-height: 200px;
    overflow-y: auto;
    z-index: 10;
    opacity: 0;
    transform: translateY(20px);
    visibility: hidden;
    transition: opacity 0.2s ease-out, transform 0.2s ease-out, visibility 0.2s;
  }

  #emojiPickerContainer.show {
    opacity: 1;
    transform: translateY(0);
    visibility: visible;
  }

  .emoji-item {
    font-size: 22px;
    cursor: pointer;
    text-align: center;
    padding: 5px;
    border-radius: 5px;
    transition: background-color 0.1s ease;
  }
  .emoji-item:hover {
    background-color: #34495e;
  }
</style>
</head>
<body>

<div id="login">
  <h2>Welcome To New Chats Site</h2>
  <input type="text" id="username" placeholder="Username" autocomplete="off" />
  <input type="password" id="password" placeholder="Password" autocomplete="off" />
  <button id="loginBtn">Login</button>
  <div id="loginError"></div>
</div>

<div id="chat">
  <div class="chat-header">
    <h2 class="glowing-title">BAPPY'S CHATTING SITE</h2>
  </div>
  <div id="messages"></div>
  <div id="inputArea">
    <button class="emoji-button" id="toggleEmojiPicker"></button>
    <textarea id="msgInput" placeholder="Type a message..." autocomplete="off" rows="1"></textarea>
    <button id="sendBtn"></button>
    <div id="emojiPickerContainer"></div>
  </div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
  import { getDatabase, ref, push, onValue, set } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-database.js";

  // Fixed usernames and passwords
  const validUsers = {
    "bappy": "1234",
    "user1": "abcd",
    "nabil": "5678"
  };

  // Your Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyAxb8vACQClmiEsB886aaHFMAitu0wEVQo",
    authDomain: "ummchat009.firebaseapp.com",
    databaseURL: "https://ummchat009-default-rtdb.firebaseio.com/",
    projectId: "ummchat009",
    storageBucket: "ummchat009.appspot.com",
    messagingSenderId: "880860486384",
    appId: "1:880860486384:web:85ce4f7ccb70eb1c5f8035"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const chatRoom = "global_chat";

  // Get elements
  const loginDiv = document.getElementById('login');
  const chatDiv = document.getElementById('chat');
  const loginBtn = document.getElementById('loginBtn');
  const loginError = document.getElementById('loginError');
  const usernameInput = document.getElementById('username');
  const passwordInput = document.getElementById('password');
  const messagesDiv = document.getElementById('messages');
  const msgInput = document.getElementById('msgInput');
  const sendBtn = document.getElementById('sendBtn');
  const toggleEmojiPickerBtn = document.getElementById('toggleEmojiPicker');
  const emojiPickerContainer = document.getElementById('emojiPickerContainer');

  let currentUser = null;
  const LOCAL_STORAGE_USERNAME_KEY = 'chatAppUsername';

  // --- Emoji Data (Expanded) ---
  const emojis = [
    'ðŸ˜€', 'ðŸ˜', 'ðŸ˜‚', 'ðŸ¤£', 'ðŸ˜ƒ', 'ðŸ˜„', 'ðŸ˜…', 'ðŸ˜†', 'ðŸ˜‰', 'ðŸ˜Š', 'ðŸ˜‹', 'ðŸ˜Ž', 'ðŸ˜', 'ðŸ˜˜', 'ðŸ˜—', 'ðŸ˜™', 'ðŸ˜š', 'ðŸ¤—', 'ðŸ¤”', 'ðŸ¤¨', 'ðŸ˜', 'ðŸ˜‘', 'ðŸ˜¶', 'ðŸ˜', 'ðŸ˜’', 'ðŸ™„', 'ðŸ˜¬', 'ðŸ¤¥', 'ðŸ˜Œ', 'ðŸ˜”', 'ðŸ˜ª', 'ðŸ¤¤', 'ðŸ˜´', 'ðŸ˜·', 'ðŸ¤’', 'ðŸ¤•', 'ðŸ¤¢', 'ðŸ¤®', 'ðŸ¤§', 'ðŸ¥µ', 'ðŸ¥¶', 'ðŸ˜µ', 'ðŸ¤¯', 'ðŸ¤ ', 'ðŸ¥³', 'ðŸ˜Ž', 'ðŸ¤“', 'ðŸ§', 'ðŸ˜•', 'ðŸ˜Ÿ', 'ðŸ™', 'ðŸ˜®', 'ðŸ˜¯', 'ðŸ˜²', 'ðŸ˜³', 'ðŸ¥º', 'ðŸ˜¦', 'ðŸ˜§', 'ðŸ˜¨', 'ðŸ˜©', 'ðŸ˜«', 'ðŸ˜¤', 'ðŸ˜ ', 'ðŸ˜¡', 'ðŸ¤¬', 'ðŸ˜ˆ', 'ðŸ‘¿', 'ðŸ’€', 'â˜ ï¸', 'ðŸ’©', 'ðŸ¤¡', 'ðŸ‘¹', 'ðŸ‘º', 'ðŸ‘»', 'ðŸ‘½', 'ðŸ‘¾', 'ðŸ¤–', 'ðŸ˜º', 'ðŸ˜¸', 'ðŸ˜¹', 'ðŸ˜»', 'ðŸ˜¼', 'ðŸ˜½', 'ðŸ™€', 'ðŸ˜¿', 'ðŸ˜¾', 'ðŸ‘‹', 'ðŸ¤š', 'ðŸ–ï¸', 'âœ‹', 'ðŸ––', 'ðŸ‘Œ', 'ðŸ¤', 'âœŒï¸', 'ðŸ¤ž', 'ðŸ¤Ÿ', 'ðŸ¤˜', 'ðŸ¤™', 'ðŸ‘ˆ', 'ðŸ‘‰', 'ðŸ‘†', 'ðŸ–•', 'ðŸ‘‡', 'â˜ï¸', 'ðŸ‘', 'ðŸ‘Ž', 'âœŠ', 'ðŸ‘Š', 'ðŸ¤›', 'ðŸ¤œ', 'ðŸ‘', 'ðŸ™Œ', 'ðŸ‘', 'ðŸ¤²', 'ðŸ¤', 'ðŸ™', 'âœï¸', 'ðŸ’…', 'ðŸ¤³', 'ðŸ’ª', 'ðŸ¦µ', 'ðŸ¦¶', 'ðŸ‘‚', 'ðŸ‘ƒ', 'ðŸ§ ', 'ðŸ¦·', 'ðŸ¦´', 'ðŸ‘€', 'ðŸ‘ï¸', 'ðŸ‘…', 'ðŸ‘„', 'ðŸ’‹', 'â¤ï¸', 'ðŸ§¡', 'ðŸ’›', 'ðŸ’š', 'ðŸ’™', 'ðŸ’œ', 'ðŸ¤Ž', 'ðŸ–¤', 'ðŸ¤', 'ðŸ’”', 'â£ï¸', 'ðŸ’•', 'ðŸ’ž', 'ðŸ’—', 'ðŸ’–', 'ðŸ’˜', 'ðŸ’“', 'ðŸ§¡', 'ðŸ’›', 'ðŸ’š', 'ðŸ’™', 'ðŸ’œ', 'ðŸ¤Ž', 'ðŸ–¤', 'ðŸ¤', 'ðŸ’Œ', 'ðŸ’¥', 'ðŸ’«', 'ðŸ’¥', 'âœ¨', 'ðŸŒŸ', 'ðŸ’«', 'ðŸ”¥', 'ðŸ’¯', 'ðŸŒˆ', 'â˜€ï¸', 'â˜”', 'â˜ï¸', 'â„ï¸', 'â˜ƒï¸', 'âš¡', 'ðŸ’§', 'ðŸŒŠ', 'ðŸ’¨', 'ðŸŒ€', 'ðŸŒŽ', 'ðŸŒ', 'ðŸŒ', 'ðŸŒ•', 'ðŸŒ–', 'ðŸŒ—', 'ðŸŒ˜', 'ðŸŒ‘', 'ðŸŒ’', 'ðŸŒ“', 'ðŸŒ”', 'ðŸŒ™', 'â­', 'ðŸŒŸ', 'ðŸ’«', 'âœ¨', 'â˜„ï¸', 'ðŸš€', 'ðŸ›¸', 'ðŸ›°ï¸', 'ðŸ’¡', 'ðŸ”¦', 'ðŸ”‹', 'ðŸ”Œ', 'ðŸ’»', 'ðŸ–¥ï¸', 'âŒ¨ï¸', 'ðŸ–±ï¸', 'ðŸ–¨ï¸', 'ðŸ“±', 'ðŸ“ž', 'â˜Žï¸', 'ðŸ“Ÿ', 'ðŸ“ ', 'ðŸ“º', 'ðŸ“»', 'ðŸŽ™ï¸', 'ðŸŽšï¸', 'ðŸŽ›ï¸', 'ðŸŽ¤', 'ðŸŽ§', 'ðŸŽ¼', 'ðŸŽµ', 'ðŸŽ¶', 'ðŸŽ·', 'ðŸŽº', 'ðŸŽ¸', 'ðŸŽ¹', 'ðŸŽ»', 'ðŸ¥', 'ðŸŽ¬', 'ðŸŽ¥', 'ðŸ“¸', 'ðŸ“¹', 'ðŸ’¡', 'ðŸ““', 'ðŸ“”', 'ðŸ“’', 'ðŸ“š', 'ðŸ“–', 'ðŸ”–', 'ðŸ·ï¸', 'ðŸ’°', 'ðŸ’³', 'ðŸ’Ž', 'ðŸ“ˆ', 'ðŸ“‰', 'ðŸ“Š', 'ðŸ””', 'ðŸ”•', 'ðŸ“¢', 'ðŸ“£', 'ðŸ’¬', 'ðŸ’­', 'ðŸ«‚', 'ðŸš¶â€â™€ï¸', 'ðŸš¶â€â™‚ï¸', 'ðŸƒâ€â™€ï¸', 'ðŸƒâ€â™‚ï¸', 'ðŸ’ƒ', 'ðŸ•º', 'ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦', 'ðŸ‘¨â€ðŸ‘©â€ðŸ‘§', 'ðŸ‘©â€ðŸ‘©â€ðŸ‘§', 'ðŸ‘¨â€ðŸ‘¨â€ðŸ‘§', 'ðŸ‘¨â€ðŸ‘©â€ðŸ‘¦â€ðŸ‘¦', 'ðŸ‘¨â€ðŸ‘¨â€ðŸ‘¦â€ðŸ‘¦', 'ðŸ‘©â€ðŸ‘©â€ðŸ‘¦â€ðŸ‘¦', 'ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦', 'ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘§', 'ðŸ‘©â€ðŸ‘©â€ðŸ‘§â€ðŸ‘§', 'ðŸ‘¨â€ðŸ‘¨â€ðŸ‘§â€ðŸ‘§', 'ðŸ‘¨â€ðŸ‘©â€ðŸ‘¦', 'ðŸ‘©â€ðŸ‘©â€ðŸ‘¦', 'ðŸ‘¨â€ðŸ‘¨â€ðŸ‘¦', 'ðŸ‘¥', 'ðŸ§‘â€ðŸ¤â€ðŸ§‘', 'ðŸ«‚', 'ðŸ¡', 'ðŸ ', 'ðŸ˜ï¸', 'ðŸ¢', 'ðŸ—ï¸', 'ðŸ­', 'â›ª', 'ðŸ•Œ', 'ðŸ›•', 'ðŸ•', 'â›©ï¸', 'ðŸ¬', 'ðŸª', 'ðŸ«', 'ðŸŽ¡', 'ðŸŽ¢', 'ðŸŽ ', 'â›²', 'ðŸ—¼', 'ðŸ—½', 'ðŸ›ï¸', 'â›°ï¸', 'ðŸ—»', 'ðŸ•ï¸', 'ðŸ–ï¸', 'ðŸœï¸', 'ðŸï¸', 'ðŸžï¸', 'ðŸ›£ï¸', 'ðŸ›¤ï¸', 'ðŸš‚', 'ðŸšƒ', 'ðŸš„', 'ðŸš…', 'ðŸš†', 'ðŸš‡', 'ðŸšˆ', 'ðŸš‰', 'ðŸšŠ', 'ðŸš—', 'ðŸš˜', 'ðŸšŒ', 'ðŸš', 'ðŸšŽ', 'ðŸš', 'ðŸš‘', 'ðŸš’', 'ðŸš“', 'ðŸš”', 'ðŸš•', 'ðŸš–', 'ðŸš—', 'ðŸš™', 'ðŸšš', 'ðŸš›', 'ðŸšœ', 'ðŸ›µ', 'ðŸš²', 'ðŸ›´', 'ðŸ›¹', 'ðŸ›º', 'âœˆï¸', 'ðŸ›«', 'ðŸ›¬', 'ðŸ’º', 'ðŸš', 'ðŸšŸ', 'ðŸš ', 'ðŸš¡', 'ðŸš¢', 'ðŸ›¥ï¸', 'ðŸš¤', 'â›µ', 'ðŸ›¶', 'â›´ï¸', 'ðŸ›³ï¸', 'âš“', 'ðŸŒ ', 'ðŸŽ‡', 'ðŸŽ†', 'ðŸŽ‘', 'ðŸŒ…', 'ðŸŒ„', 'ðŸŒ†', 'ðŸŒƒ', 'ðŸŒ‰', 'ðŸŒ', 'âŒš', 'ðŸ“±', 'ðŸ’»', 'ðŸ–¥ï¸', 'âŒ¨ï¸', 'ðŸ–±ï¸', 'ðŸ–¨ï¸', 'ðŸ’¾', 'ðŸ’¿', 'ðŸ“€', 'ðŸ’½', 'ðŸ“¼', 'ðŸ“·', 'ðŸ“¸', 'ðŸ“¹', 'ðŸŽ¥', 'ðŸ“ž', 'â˜Žï¸', 'ðŸ“Ÿ', 'ðŸ“ ', 'ðŸ“º', 'ðŸ“»', 'ðŸŽ™ï¸', 'ðŸŽšï¸', 'ðŸŽ›ï¸', 'ðŸŽ¤', 'ðŸŽ§', 'ðŸŽ¼', 'ðŸŽµ', 'ðŸŽ¶', 'ðŸŽ·', 'ðŸŽº', 'ðŸŽ¸', 'ðŸŽ¹', 'ðŸŽ»', 'ðŸ¥', 'ðŸŽ¯', 'ðŸŽ³', 'ðŸŽ±', 'ðŸŽ²', 'â™Ÿï¸', 'ðŸŽ®', 'ðŸŽ°', 'ðŸ§©', 'ðŸ†', 'ðŸ…', 'ðŸ¥‡', 'ðŸ¥ˆ', 'ðŸ¥‰', 'âš½', 'âš¾', 'ðŸ¥Ž', 'ðŸ€', 'ðŸ', 'ðŸˆ', 'ðŸ‰', 'ðŸŽ¾', 'ðŸ¥', 'ðŸªƒ', 'ðŸ', 'ðŸ‘', 'ðŸ’', 'ðŸ¥', 'ðŸ“', 'ðŸ¸', 'ðŸ¥Š', 'ðŸ¥‹', 'ðŸ¥…', 'â›³', 'â›¸ï¸', 'ðŸŽ£', 'ðŸ¤¿', 'ðŸŽ½', 'ðŸŽ¿', 'ðŸ›·', 'ðŸ¥Œ', 'ðŸª¢', 'ðŸª', 'ðŸ›¼', 'ðŸ¤¿', 'ðŸ¤¼â€â™€ï¸', 'ðŸ¤¼â€â™‚ï¸', 'ðŸ¤¸â€â™€ï¸', 'ðŸ¤¸â€â™‚ï¸', 'â›¹ï¸â€â™€ï¸', 'â›¹ï¸â€â™‚ï¸', 'ðŸ¤¾â€â™€ï¸', 'ðŸ¤¾â€â™‚ï¸', 'ðŸ¤º', 'ðŸ‹ï¸â€â™€ï¸', 'ðŸ‹ï¸â€â™‚ï¸', 'ðŸ§˜â€â™€ï¸', 'ðŸ§˜â€â™‚ï¸', 'ðŸ›€', 'ðŸ›Œ', 'ðŸ›‹ï¸', 'ðŸª‘', 'ðŸš½', 'ðŸš¿', 'ðŸ›', 'ðŸ§¼', 'ðŸª¥', 'ðŸª’', 'ðŸ§º', 'ðŸ§»', 'ðŸš½', 'ðŸ§¹', 'ðŸª£', 'ðŸ§´', 'ðŸ§½', 'ðŸ§¼', 'ðŸ§º', 'ðŸª£', 'ðŸ§´', 'ðŸ§½', 'ðŸ—ï¸', 'ðŸ”‘', 'ðŸšª', 'ðŸªž', 'ðŸªŸ', 'ðŸ›ï¸', 'ðŸªŸ', 'ðŸª‘', 'ðŸš½', 'ðŸš¿', 'ðŸ›', 'ðŸ§¼', 'ðŸª¥', 'ðŸª’', 'ðŸ§º', 'ðŸ§»', 'ðŸš½', 'ðŸ§¹', 'ðŸª£', 'ðŸ§´', 'ðŸ§½', 'ðŸŽ', 'ðŸ', 'ðŸŠ', 'ðŸ‹', 'ðŸŒ', 'ðŸ‰', 'ðŸ‡', 'ðŸ“', 'ðŸˆ', 'ðŸ’', 'ðŸ‘', 'ðŸ¥­', 'ðŸ', 'ðŸ¥¥', 'ðŸ¥', 'ðŸ…', 'ðŸ†', 'ðŸ¥‘', 'ðŸ¥¦', 'ðŸ¥¬', 'ðŸ¥’', 'ðŸŒ¶ï¸', 'ðŸŒ½', 'ðŸ¥•', 'ðŸ¥”', 'ðŸ ', 'ðŸ¥', 'ðŸž', 'ðŸ¥–', 'ðŸ¥¨', 'ðŸ¥¯', 'ðŸ¥ž', 'ðŸ§‡', 'ðŸ§€', 'ðŸ–', 'ðŸ—', 'ðŸ¥©', 'ðŸ¥“', 'ðŸ”', 'ðŸŸ', 'ðŸ•', 'ðŸŒ­', 'ðŸ¥ª', 'ðŸŒ®', 'ðŸŒ¯', 'ðŸ¥™', 'ðŸ§†', 'ðŸ¥š', 'ðŸ³', 'ðŸ²', 'ðŸ¥£', 'ðŸ¥—', 'ðŸ¿', 'ðŸ§ˆ', 'ðŸ§‚', 'ðŸ¥«', 'ðŸ±', 'ðŸ˜', 'ðŸ™', 'ðŸš', 'ðŸ›', 'ðŸœ', 'ðŸ', 'ðŸ ', 'ðŸ¢', 'ðŸ£', 'ðŸ¤', 'ðŸ¥', 'ðŸ¥®', 'ðŸ¡', 'ðŸ¥Ÿ', 'ðŸ¥ ', 'ðŸ¥¡', 'ðŸ¦', 'ðŸ§', 'ðŸ¨', 'ðŸ©', 'ðŸª', 'ðŸŽ‚', 'ðŸ°', 'ðŸ§', 'ðŸ¥§', 'ðŸ«', 'ðŸ¬', 'ðŸ­', 'ðŸ®', 'ðŸ¯', 'ðŸ¼', 'ðŸ¥›', 'â˜•', 'ðŸµ', 'ðŸ¶', 'ðŸ¾', 'ðŸ·', 'ðŸ¸', 'ðŸ¹', 'ðŸº', 'ðŸ»', 'ðŸ¥‚', 'ðŸ¥ƒ', 'ðŸ¥¤', 'ðŸ§‰', 'ðŸ§Š', 'ðŸ¥„', 'ðŸ´', 'ðŸ½ï¸', 'ðŸ¥£', 'ðŸ¥¡', 'ðŸ¥¢', 'ðŸš', 'ðŸ¥«', 'ðŸ¿', 'ðŸ§Š', 'ðŸ§‰', 'ðŸ¥¤', 'ðŸ¥ƒ', 'ðŸ¥‚', 'ðŸ»', 'ðŸº', 'ðŸ¹', 'ðŸ¸', 'ðŸ·', 'ðŸ¾', 'ðŸ¶', 'ðŸµ', 'â˜•', 'ðŸ¥›', 'ðŸ¼', 'ðŸ¯', 'ðŸ®', 'ðŸ­', 'ðŸ¬', 'ðŸ«', 'ðŸ¥§', 'ðŸ§', 'ðŸ°', 'ðŸŽ‚', 'ðŸª', 'ðŸ©', 'ðŸ¨', 'ðŸ§', 'ðŸ¦', 'ðŸ¥¡', 'ðŸ¥ ', 'ðŸ¥Ÿ', 'ðŸ¡', 'ðŸ¥®', 'ðŸ¥', 'ðŸ¤', 'ðŸ£', 'ðŸ¢', 'ðŸ ', 'ðŸ', 'ðŸœ', 'ðŸ›', 'ðŸš', 'ðŸ™', 'ðŸ˜', 'ðŸ±', 'ðŸ¥«', 'ðŸ§‚', 'ðŸ§ˆ', 'ðŸ¿', 'ðŸ¥—', 'ðŸ¥£', 'ðŸ²', 'ðŸ³', 'ðŸ¥š', 'ðŸ§†', 'ðŸ¥™', 'ðŸŒ¯', 'ðŸŒ®', 'ðŸ¥ª', 'ðŸŒ­', 'ðŸ•', 'ðŸŸ', 'ðŸ”', 'ðŸ¥“', 'ðŸ¥©', 'ðŸ—', 'ðŸ–', 'ðŸ§€', 'ðŸ§‡', 'ðŸ¥ž', 'ðŸ¥¯', 'ðŸ¥¨', 'ðŸ¥–', 'ðŸž', 'ðŸ¥', 'ðŸ ', 'ðŸ¥•', 'ðŸŒ½', 'ðŸŒ¶ï¸', 'ðŸ¥’', 'ðŸ¥¬', 'ðŸ¥¦', 'ðŸ¥‘', 'ðŸ†', 'ðŸ…', 'ðŸ¥', 'ðŸ¥¥', 'ðŸ', 'ðŸ¥­', 'ðŸ‘', 'ðŸ’', 'ðŸˆ', 'ðŸ“', 'ðŸ‡', 'ðŸ‰', 'ðŸŒ', 'ðŸ‹', 'ðŸŠ', 'ðŸ', 'ðŸŽ', 'ðŸ•', 'ðŸˆ', 'ðŸ', 'ðŸ€', 'ðŸ¹', 'ðŸ°', 'ðŸ»', 'ðŸ¼', 'ðŸ¨', 'ðŸ¯', 'ðŸ¦', 'ðŸ®', 'ðŸ·', 'ðŸ½', 'ðŸ¸', 'ðŸµ', 'ðŸ’', 'ðŸ¶', 'ðŸº', 'ðŸ¦Š', 'ðŸ¦', 'ðŸˆ', 'ðŸ…', 'ðŸ†', 'ðŸŽ', 'ðŸ¦“', 'ðŸ¦Œ', 'ðŸ¦¬', 'ðŸƒ', 'ðŸ‚', 'ðŸ„', 'ðŸ·', 'ðŸ—', 'ðŸ', 'ðŸ‘', 'ðŸ', 'ðŸª', 'ðŸ«', 'ðŸ¦™', 'ðŸ¦’', 'ðŸ˜', 'ðŸ¦', 'ðŸ¦›', 'ðŸ­', 'ðŸ', 'ðŸ€', 'ðŸ¹', 'ðŸ°', 'ðŸ¿ï¸', 'ðŸ¦”', 'ðŸ¦‡', 'ðŸ»', 'ðŸ¨', 'ðŸ¼', 'ðŸ¦¥', 'ðŸ¦¦', 'ðŸ¦¨', 'ðŸ¦˜', 'ðŸ¦¡', 'ðŸ¾', 'ðŸ¦ƒ', 'ðŸ”', 'ðŸ“', 'ðŸ£', 'ðŸ¤', 'ðŸ¥', 'ðŸ¦', 'ðŸ§', 'ðŸ•Šï¸', 'ðŸ¦…', 'ðŸ¦†', 'ðŸ¦¢', 'ðŸ¦‰', 'ðŸ¦©', 'ðŸ¦š', 'ðŸ¦œ', 'ðŸ¸', 'ðŸŠ', 'ðŸ¢', 'ðŸ¦Ž', 'ðŸ', 'ðŸ²', 'ðŸ‰', 'ðŸ¦•', 'ðŸ¦–', 'ðŸ³', 'ðŸ‹', 'ðŸ¬', 'ðŸŸ', 'ðŸ ', 'ðŸ¡', 'ðŸ¦ˆ', 'ðŸ™', 'ðŸš', 'ðŸŒ', 'ðŸ¦‹', 'ðŸ›', 'ðŸœ', 'ðŸ', 'ðŸž', 'ðŸ¦—', 'ðŸ•·ï¸', 'ðŸ•¸ï¸', 'ðŸ¦‚', 'ðŸ¦Ÿ', 'ðŸ¦ ', 'ðŸ’', 'ðŸŒ¸', 'ðŸ’®', 'ðŸŒ¹', 'ðŸ¥€', 'ðŸŒº', 'ðŸŒ»', 'ðŸŒ¼', 'ðŸŒ·', 'ðŸŒ±', 'ðŸŒ²', 'ðŸŒ³', 'ðŸŒ´', 'ðŸŒµ', 'ðŸŒ¾', 'â˜˜ï¸', 'ðŸ€', 'ðŸ', 'ðŸ‚', 'ðŸƒ', 'ðŸ„', 'ðŸŒ°', 'ðŸŒ', 'ðŸŒŽ', 'ðŸŒ', 'ðŸŒ', 'ðŸ—ºï¸', 'ðŸ§­', 'ðŸ”ï¸', 'â›°ï¸', 'ðŸŒ‹', 'ðŸ—»', 'ðŸ•ï¸', 'ðŸ–ï¸', 'ðŸœï¸', 'ðŸï¸', 'ðŸžï¸', 'ðŸ˜ï¸', 'ðŸ¡', 'ðŸ ', 'ðŸ¢', 'ðŸ£', 'ðŸ¤', 'ðŸ¥', 'ðŸ¦', 'ðŸ¨', 'ðŸ©', 'ðŸ«', 'ðŸª', 'ðŸ­', 'â›ª', 'ðŸ•Œ', 'ðŸ•', 'â›©ï¸', 'ðŸ•‹', 'â›²', 'ðŸ›ï¸', ' Ø¨Ø±Ø¬', 'ðŸ—¼', 'ðŸ—½', 'ðŸŒ‰', 'ðŸ›£ï¸', ' rail', 'ðŸš‚', 'ðŸšƒ', 'ðŸš„', 'ðŸš…', 'ðŸš†', 'ðŸš‡', 'ðŸšˆ', 'ðŸš‰', 'ðŸšŠ', 'ðŸš', 'ðŸšž', 'ðŸš‹', 'ðŸšŒ', 'ðŸš', 'ðŸšŽ', 'ðŸš', 'ðŸš‘', 'ðŸš’', 'ðŸš“', 'ðŸš”', 'ðŸš•', 'ðŸš–', 'ðŸš—', 'ðŸš™', 'ðŸšš', 'ðŸš›', 'ðŸšœ', 'ðŸ›µ', 'ðŸš²', 'ðŸ›´', 'ðŸ›¹', 'ðŸ›º', 'ðŸš¦', 'ðŸš§', 'ðŸ›‘', 'ðŸš¨', 'âœˆï¸', 'ðŸ›«', 'ðŸ›¬', 'ðŸ’º', 'ðŸš', 'ðŸšŸ', 'ðŸš ', 'ðŸš¡', 'ðŸš¢', 'ðŸ›¥ï¸', 'ðŸš¤', 'â›µ', 'ðŸ›¶', 'â›´ï¸', 'ðŸ›³ï¸', 'âš“', 'ðŸŒ ', 'ðŸŽ‡', 'ðŸŽ†', 'ðŸŽ‘', 'ðŸŒ…', 'ðŸŒ„', 'ðŸŒ†', 'ðŸŒƒ', 'ðŸŒ‰', 'ðŸŒ', 'âŒš', 'ðŸ“±', 'ðŸ’»', 'ðŸ–¥ï¸', 'âŒ¨ï¸', 'ðŸ–±ï¸', 'ðŸ–¨ï¸', 'ðŸ’¾', 'ðŸ’¿', 'ðŸ“€', 'ðŸ’½', 'ðŸ“¼', 'ðŸ“·', 'ðŸ“¸', 'ðŸ“¹', 'ðŸŽ¥', 'ðŸ“ž', 'â˜Žï¸', 'ðŸ“Ÿ', 'ðŸ“ ', 'ðŸ“º', 'ðŸ“»', 'ðŸŽ™ï¸', 'ðŸŽšï¸', 'ðŸŽ›ï¸', 'ðŸŽ¤', 'ðŸŽ§', 'ðŸŽ¼', 'ðŸŽµ', 'ðŸŽ¶', 'ðŸŽ·', 'ðŸŽº', 'ðŸŽ¸', 'ðŸŽ¹', 'ðŸŽ»', 'ðŸ¥', 'ðŸŽ¯', 'ðŸŽ³', 'ðŸŽ±', 'ðŸŽ²', 'â™Ÿï¸', 'ðŸŽ®', 'ðŸŽ°', 'ðŸ§©', 'ðŸ†', 'ðŸ…', 'ðŸ¥‡', 'ðŸ¥ˆ', 'ðŸ¥‰', 'âš½', 'âš¾', 'ðŸ¥Ž', 'ðŸ€', 'ðŸ', 'ðŸˆ', 'ðŸ‰', 'ðŸŽ¾', 'ðŸ¥', 'ðŸªƒ', 'ðŸ', 'ðŸ‘', 'ðŸ’', 'ðŸ¥', 'ðŸ“', 'ðŸ¸', 'ðŸ¥Š', 'ðŸ¥‹', 'ðŸ¥…', 'â›³', 'â›¸ï¸', 'ðŸŽ£', 'ðŸ¤¿', 'ðŸŽ½', 'ðŸŽ¿', 'ðŸ›·', 'ðŸ¥Œ', 'ðŸª¢', 'ðŸª', 'ðŸ›¼', 'ðŸ¤¿', 'ðŸ¤¼â€â™€ï¸', 'ðŸ¤¼â€â™‚ï¸', 'ðŸ¤¸â€â™€ï¸', 'ðŸ¤¸â€â™‚ï¸', 'â›¹ï¸â€â™€ï¸', 'â›¹ï¸â€â™‚ï¸', 'ðŸ¤¾â€â™€ï¸', 'ðŸ¤¾â€â™‚ï¸', 'ðŸ¤º', 'ðŸ‹ï¸â€â™€ï¸', 'ðŸ‹ï¸â€â™‚ï¸', 'ðŸ§˜â€â™€ï¸', 'ðŸ§˜â€â™‚ï¸', 'ðŸ›€', 'ðŸ›Œ', 'ðŸ›‹ï¸', 'ðŸª‘', 'ðŸš½', 'ðŸš¿', 'ðŸ›', 'ðŸ§¼', 'ðŸª¥', 'ðŸª’', 'ðŸ§º', 'ðŸ§»', 'ðŸš½', 'ðŸ§¹', 'ðŸª£', 'ðŸ§´', 'ðŸ§½', 'ðŸ§¼', 'ðŸ§º', 'ðŸª£', 'ðŸ§´', 'ðŸ§½', 'ðŸ—ï¸', 'ðŸ”‘', 'ðŸšª', 'ðŸªž', 'ðŸªŸ', 'ðŸ›ï¸', 'ðŸªŸ', 'ðŸª‘', 'ðŸš½', 'ðŸš¿', 'ðŸ›', 'ðŸ§¼', 'ðŸª¥', 'ðŸª’', 'ðŸ§º', 'ðŸ§»', 'ðŸš½', 'ðŸ§¹', 'ðŸª£', 'ðŸ§´', 'ðŸ§½'
Â  ];


Â  // Function to load user from local storage
Â  function loadUserFromLocalStorage() {
Â  Â  const storedUsername = localStorage.getItem(LOCAL_STORAGE_USERNAME_KEY);
Â  Â  if (storedUsername && validUsers[storedUsername]) {
Â  Â  Â  currentUser = storedUsername;
Â  Â  Â  loginDiv.style.display = 'none';
Â  Â  Â  chatDiv.style.display = 'flex';
Â  Â  Â  startChat();
Â  Â  Â  return true;
Â  Â  }
Â  Â  return false;
Â  }

Â  // Attempt to load user on page load
Â  if (!loadUserFromLocalStorage()) {
Â  Â  loginDiv.style.display = 'flex';
Â  }

Â  loginBtn.onclick = () => {
Â  Â  const username = usernameInput.value.trim();
Â  Â  const password = passwordInput.value.trim();

Â  Â  if (validUsers[username] && validUsers[username] === password) {
Â  Â  Â  currentUser = username;
Â  Â  Â  localStorage.setItem(LOCAL_STORAGE_USERNAME_KEY, currentUser);
Â  Â  Â  loginDiv.style.display = 'none';
Â  Â  Â  chatDiv.style.display = 'flex';
Â  Â  Â  loginError.textContent = '';
Â  Â  Â  startChat();
Â  Â  } else {
Â  Â  Â  loginError.textContent = 'Invalid username or password!';
Â  Â  Â  usernameInput.value = '';
Â  Â  Â  passwordInput.value = '';
Â  Â  Â  usernameInput.focus();
Â  Â  }
Â  };

Â  function startChat() {
Â  Â  const chatRef = ref(db, "chats/" + chatRoom);

Â  Â  onValue(chatRef, (snapshot) => {
Â  Â  Â  messagesDiv.innerHTML = '';
Â  Â  Â  snapshot.forEach(child => {
Â  Â  Â  Â  const msg = child.val();
Â  Â  Â  Â  const div = document.createElement('div');
Â  Â  Â  Â  div.classList.add('msg');
Â  Â  Â  Â  div.classList.add(msg.user === currentUser ? 'me' : 'other');
Â  Â  Â  Â  div.textContent = `${msg.user}: ${msg.text}`;
Â  Â  Â  Â  messagesDiv.appendChild(div);
Â  Â  Â  });
Â  Â  Â  messagesDiv.scrollTop = messagesDiv.scrollHeight;
Â  Â  });

Â  Â  // --- Message Sending Logic ---
Â  Â  function sendMessage() {
Â  Â  Â  const text = msgInput.value.trim();
Â  Â  Â  if (!text) return;

Â  Â  Â  const chatRefPush = ref(db, "chats/" + chatRoom);
Â  Â  Â  push(chatRefPush, {
Â  Â  Â  Â  user: currentUser,
Â  Â  Â  Â  text: text,
Â  Â  Â  Â  timestamp: Date.now()
Â  Â  Â  });
Â  Â  Â  msgInput.value = ''; // Clear input field after sending
Â  Â  Â  msgInput.style.height = 'auto'; // Reset textarea height
Â  Â  Â  msgInput.focus();
Â  Â  }

Â  Â  sendBtn.onclick = sendMessage;

Â  Â  msgInput.addEventListener('keypress', (e) => {
Â  Â  Â  if (e.key === 'Enter' && !e.shiftKey) { // Send on Enter, new line on Shift+Enter
Â  Â  Â  Â  e.preventDefault(); // Prevent default Enter key behavior (new line)
Â  Â  Â  Â  sendMessage();
Â  Â  Â  }
Â  Â  });

Â  Â  // --- Auto-resize textarea for multi-line input ---
Â  Â  msgInput.addEventListener('input', () => {
Â  Â  Â  msgInput.style.height = 'auto';
Â  Â  Â  msgInput.style.height = msgInput.scrollHeight + 'px';
Â  Â  });


Â  Â  // --- Emoji Picker Logic ---
Â  Â  function populateEmojiPicker() {
Â  Â  Â  emojiPickerContainer.innerHTML = ''; // Clear previous emojis
Â  Â  Â  emojis.forEach(emoji => {
Â  Â  Â  Â  const span = document.createElement('span');
Â  Â  Â  Â  span.classList.add('emoji-item');
Â  Â  Â  Â  span.textContent = emoji;
Â  Â  Â  Â  span.onclick = () => {
Â  Â  Â  Â  Â  const start = msgInput.selectionStart;
Â  Â  Â  Â  Â  const end = msgInput.selectionEnd;
Â  Â  Â  Â  Â  const text = msgInput.value;
Â  Â  Â  Â  Â  msgInput.value = text.substring(0, start) + emoji + text.substring(end);
Â  Â  Â  Â  Â  msgInput.selectionStart = msgInput.selectionEnd = start + emoji.length;
Â  Â  Â  Â  Â  msgInput.focus();
Â  Â  Â  Â  Â  msgInput.dispatchEvent(new Event('input')); // Trigger input event for auto-resize
Â  Â  Â  Â  Â  emojiPickerContainer.classList.remove('show'); // Hide picker after selection
Â  Â  Â  Â  };
Â  Â  Â  Â  emojiPickerContainer.appendChild(span);
Â  Â  Â  });
Â  Â  }

Â  Â  toggleEmojiPickerBtn.onclick = (event) => {
Â  Â  Â  event.stopPropagation(); // Prevent click from bubbling to document and closing picker
Â  Â  Â  emojiPickerContainer.classList.toggle('show');
Â  Â  Â  if (emojiPickerContainer.classList.contains('show')) {
Â  Â  Â  Â  populateEmojiPicker(); // Populate only when shown
Â  Â  Â  }
Â  Â  };

Â  Â  // Close emoji picker if clicked outside or on a message
Â  Â  document.addEventListener('click', (event) => {
Â  Â  Â  if (!emojiPickerContainer.contains(event.target) && event.target !== toggleEmojiPickerBtn && !event.target.closest('.msg')) {
Â  Â  Â  Â  emojiPickerContainer.classList.remove('show');
Â  Â  Â  }
Â  Â  });

Â  Â  // Prevent emoji picker from closing when clicking inside it
Â  Â  emojiPickerContainer.addEventListener('click', (event) => {
Â  Â  Â  event.stopPropagation();
Â  Â  });
Â  }
</script>

</body>
</html>
